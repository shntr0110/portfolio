---
import Layout from '@layouts/Layout.astro';
import Hero from '@components/partials/Hero.astro';
import Button from '@components/partials/Button.astro';

import { getWorks, getWorkDetail } from '../../lib/microcms';

// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
  const response = await getWorks({ fields: ['id'] });
  return response.contents.map((content) => ({
    params: {
      workId: content.id,
    },
  }));
}

//記事の詳細情報を取得
const { workId } = Astro.params;
const work = await getWorkDetail(workId as string);

const title = '制作実績:' + work.title;
const description = '制作実績の概要や使用したツール・技術についてご紹介します。';
---

<Layout title={title} description={description}>
  <div class="container mb-[120px] lg:mb-40">
    <div class="aspect-[1.6] w-full border border-solid border-[#cccccc] lg:aspect-[1.8]">
      <img src={work.thumbnail?.url} alt="" class="size-full object-cover" />
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">サイトURL</h2>
      <div
        class="mt-[15px] [&_a]:text-16 [&_a]:leading-160 [&_a]:text-blue [&_a]:link [&_p]:leading-200"
        set:html={work.siteUrl}
      />
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">プロジェクト詳細</h2>
      <div class="mt-[15px] [&_p]:text-16 [&_p]:leading-200" set:html={work.description} />
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">コーディング実装期間</h2>
      <p class="mt-[15px] text-16 leading-160">{work.period}</p>
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">使用ツール・技術</h2>
      <ul class="mt-[15px] flex flex-col gap-3">
        {
          work.technologies.map((technology) => (
            <li class="relative pl-[18px] before:absolute before:left-0 before:top-1/2 before:size-2 before:-translate-y-1/2 before:rounded-full before:bg-blue">
              <p class="text-16 leading-160">{technology.name}</p>
            </li>
          ))
        }
      </ul>
    </div>
    <div class="mx-auto mt-[60px] w-fit lg:mt-20">
      <Button link="/works" name="一覧へ戻る" />
    </div>
  </div>
</Layout>
