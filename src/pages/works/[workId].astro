---
import Layout from '@layouts/Layout.astro';
import Hero from '@components/partials/Hero.astro';
import Button from '@components/partials/Button.astro';

import { getWorks, getWorkDetail } from '../../lib/microcms';

// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
  const response = await getWorks({ fields: ['id'] });
  return response.contents.map((content) => ({
    params: {
      workId: content.id,
    },
  }));
}

//記事の詳細情報を取得
const { workId } = Astro.params;
const work = await getWorkDetail(workId as string);

const title = 'ブログ';
const description = 'sdenvに関するブログの一覧です。';
---

<Layout title={title} description={description}>
  <Hero title={work.title} titleSub={work.titleSub} />
  <div class="container my-[100px] lg:my-[120px]">
    <div class="aspect-[1.8] w-full border border-solid border-black">
      <img src={work.thumbnail?.url} alt="" class="size-full object-cover" />
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">サイトURL</h2>
      <p class="mt-[15px] lg:mt-[20px]">
        <a
          href={work.siteUrl}
          target="_blank"
          rel="noopener"
          class="text-16 leading-160 text-blue link">{work.siteUrl}</a
        >
      </p>
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">概要</h2>
      <p class="mt-5 text-16 leading-160 lg:mt-[30px]">{work.description}</p>
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">制作期間</h2>
      <p class="mt-5 text-16 leading-160 lg:mt-[30px]">{work.period}</p>
    </div>
    <div class="mt-[60px] lg:mt-20">
      <h2 class="works-heading">使用ツール・技術</h2>
      <ul class="mt-5 flex flex-col gap-3 lg:mt-[30px]">
        {
          work.technologies.map((technology) => (
            <li class="relative pl-[18px] before:absolute before:left-0 before:top-1/2 before:size-2 before:-translate-y-1/2 before:rounded-full before:bg-blue">
              <p class="text-16 leading-160">{technology.name}</p>
            </li>
          ))
        }
      </ul>
    </div>
    <div class="mt-[60px] text-center lg:mt-20">
      <Button link="/works" name="一覧へ戻る" />
    </div>
  </div>
</Layout>
